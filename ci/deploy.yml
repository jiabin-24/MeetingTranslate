# deploy.yml - contains the deploy_environment job (manual trigger)
deploy_environment:
  extends: .azure_login
  stage: run
  interruptible: true
  rules:
    - when: manual
  script:
    - |
      pwsh -NoProfile -NonInteractive -Command "& {
        $Params = @{ OrgName = $env:ORG_NAME; Location = $env:LOCATION; FullUpload = $true }
        ./ADF/main.ps1 @Params
        if ($Error.Count -gt 0) { throw $Error[0] }
      }"
